<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Техно-Хаб: Кабинет Учителя</title>
    <style>
        /* Стиль: Тёмная ламповая минималистика */
        :root {
            --bg: #0f0f0f;
            --panel: #1a1a1a;
            --accent: #ff9800; /* Теплый янтарный свет */
            --text: #e0e0e0;
            --border: #333;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            height: 100vh;
        }

        /* Навигация справа (как просил) */
        nav {
            width: 240px;
            background: var(--panel);
            border-left: 1px solid var(--border);
            order: 2; /* Перемещает меню вправо */
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        nav h2 { color: var(--accent); font-size: 1.1rem; text-align: center; margin-bottom: 30px; }

        nav button {
            background: transparent;
            border: 1px solid transparent;
            color: var(--text);
            padding: 12px;
            text-align: left;
            cursor: pointer;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: 0.3s;
        }

        nav button:hover, nav button.active {
            background: #252525;
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Контент слева */
        main {
            flex: 1;
            padding: 30px;
            order: 1;
            overflow-y: auto;
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--panel);
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 12px;
            transition: 0.3s;
        }

        .card:hover { border-color: var(--accent); transform: translateY(-3px); }

        .card a { color: var(--accent); text-decoration: none; font-weight: bold; }

        /* Чат */
        .chat-wrapper {
            background: var(--panel);
            border-radius: 12px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
        }

        #chat-output {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .msg { padding: 10px 15px; border-radius: 10px; max-width: 85%; line-height: 1.5; }
        .user-msg { background: #333; align-self: flex-end; }
        .ai-msg { background: rgba(255,152,0,0.1); border: 1px solid var(--accent); align-self: flex-start; }

        .chat-input-area {
            padding: 15px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
        }

        input {
            flex: 1;
            background: #222;
            border: 1px solid var(--border);
            color: white;
            padding: 12px;
            border-radius: 8px;
            outline: none;
        }

        button.send { background: var(--accent); border: none; padding: 0 20px; border-radius: 8px; cursor: pointer; font-weight: bold; }

        .loader { display: none; color: var(--accent); font-size: 0.8rem; padding-left: 20px; margin-bottom: 10px; }
    </style>
</head>
<body>

<nav>
    <h2>Мастерская ИИ</h2>
    <button class="active" onclick="showTab('home')">Главная</button>
    <button onclick="showTab('tools')">Инструменты</button>
    <button onclick="showTab('ai')">Чат с Gemini</button>
</nav>

<main>
    <div id="home" class="tab-content active">
        <h1>Рабочий стол учителя</h1>
        <div class="card-grid">
            <div class="card">
                <h3>Текстовые редакторы</h3>
                <p>Google Docs, Notion, Word Online.</p>
                <a href="https://docs.google.com" target="_blank">Перейти →</a>
            </div>
            <div class="card">
                <h3>ИИ Сервисы</h3>
                <p>ChatGPT, Claude, Perplexity.</p>
                <a href="https://www.perplexity.ai" target="_blank">Перейти →</a>
            </div>
        </div>
    </div>

    <div id="tools" class="tab-content">
        <h1>3D и Черчение</h1>
        <div class="card-grid">
            <div class="card">
                <h3>Tinkercad</h3>
                <p>Легкое 3D моделирование для учеников.</p>
                <a href="https://www.tinkercad.com" target="_blank">Открыть →</a>
            </div>
            <div class="card">
                <h3>Onshape</h3>
                <p>Профессиональный САПР в браузере.</p>
                <a href="https://www.onshape.com" target="_blank">Открыть →</a>
            </div>
        </div>
    </div>

    <div id="ai" class="tab-content">
        <h1>Ассистент Gemini 1.5 Flash</h1>
        <div class="chat-wrapper">
            <div id="chat-output">
                <div class="msg ai-msg">Привет! Я готов помочь с чертежами, планами уроков или теорией. Что подсказать?</div>
            </div>
            <div id="loader" class="loader">ИИ обдумывает ответ...</div>
            <div class="chat-input-area">
                <input type="text" id="user-input" placeholder="Введите вопрос..." onkeydown="if(event.key==='Enter') sendMsg()">
                <button class="send" onclick="sendMsg()">Отправить</button>
            </div>
        </div>
    </div>
</main>

<script>
    // Твой ключ API (уже вставлен в кавычки)
    const KEY = "AIzaSyCMwiakZUy7olCszQ_A_hvfj3kMOhRjaR0";

    function showTab(id) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    async function sendMsg() {
        const input = document.getElementById('user-input');
        const output = document.getElementById('chat-output');
        const loader = document.getElementById('loader');
        const text = input.value.trim();

        if (!text) return;

        // Показываем сообщение пользователя
        output.innerHTML += `<div class="msg user-msg">${text}</div>`;
        input.value = '';
        output.scrollTop = output.scrollHeight;
        loader.style.display = 'block';

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: "Ты ассистент учителя технологии. Отвечай на русском. " + text }] }]
                })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content) {
                const aiResponse = data.candidates[0].content.parts[0].text;
                // Форматируем переносы строк и жирный текст
                const htmlResponse = aiResponse.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\n/g, '<br>');
                output.innerHTML += `<div class="msg ai-msg">${htmlResponse}</div>`;
            } else {
                throw new Error("Пустой ответ. Возможно, ограничения региона.");
            }
        } catch (err) {
            output.innerHTML += `<div class="msg ai-msg" style="color: #ff6b6b">Ошибка: ${err.message}. Попробуйте использовать VPN, если вы в РФ.</div>`;
        } finally {
            loader.style.display = 'none';
            output.scrollTop = output.scrollHeight;
        }
    }
</script>

</body>
</html>
